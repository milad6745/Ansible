# Vault
در انسیبل، `vault` به معنی "حجره" است و اشاره دارد به یک ابزار که برای مدیریت و نگهداری اطلاعات حساس (مثل رمزعبورها، توکن‌ها و سایر اطلاعات محرمانه) به کار می‌رود. این اطلاعات معمولاً در فایل‌های متنی واضح ذخیره نمی‌شوند تا از دسترسی غیرمجاز جلوگیری شود.

 در انسیبل برای مدیریت اطلاعات محرمانه به کار می‌رود. به این صورت که اطلاعات مهم مانند رمزعبورها یا توکن‌ها درون `vault` ذخیره می‌شوند و سپس در هنگام اجرای تسک‌ها، انسیبل می‌تواند از `vault` این اطلاعات را بازیابی کند.

استفاده از `vault` به امنیت و مدیریت بهتر اطلاعات محرمانه در اسکریپت‌ها و پلی بوک‌های انسیبل کمک می‌کند.

اینجا یک نمونه کوتاه از استفاده از `vault` در انسیبل:


بله، مثالی از استفاده از `ansible-vault` در Ansible را در ادامه می‌آورم.

مثال:
فرض کنید می‌خواهیم یک فایل YAML را رمزگذاری کنیم که شامل اطلاعات حساب کاربری MySQL باشد. 

1. ابتدا با دستور زیر یک فایل YAML جدید به نام `mysql_creds.yml` ایجاد کنید:

```yaml
mysql_user: my_username
mysql_password: my_password
```

2. حالا از دستور `ansible-vault` برای رمزگذاری این فایل استفاده می‌کنیم:

```
ansible-vault encrypt mysql_creds.yml
```

بعد از اجرای این دستور، شما باید یک رمز عبور برای رمزگذاری وارد کنید.

3. حالا محتویات فایل `mysql_creds.yml` رمزگذاری شده و نمی‌توانید آن را به راحتی بخوانید.

برای دسترسی به محتویات فایل رمزگذاری شده و ویرایش آن، از دستور `ansible-vault edit` استفاده می‌کنیم:

```
ansible-vault edit mysql_creds.yml
```

این دستور شما را به ویرایشگر متناوبی می‌برد و پس از ویرایش، تغییرات را ذخیره می‌کند.

برای اجرای دستورات Ansible با استفاده از فایل رمزگذاری شده، باید Ansible اطلاعات را با دستور `ansible-playbook` و توضیحات `--ask-vault-pass` و یا `--vault-password-file` از شما دریافت کند.

مثال:
```
ansible-playbook my_playbook.yml --ask-vault-pass
```

در این مثال، Ansible از شما رمز عبور را دریافت می‌کند و با آن فایل رمزگذاری شده را باز می‌کند.

## Decrypt فایل
```
ansible-vault decrypt my_playbook.yml
```

## دیدن فایل
```
ansible-vault view my_playbook.yml
```

## تغییر رمز فایل encrypt شده

ا `ansible-vault rkey`  یک دستور Ansible-Vault است که برای تغییر کلید رمزگذاری استفاده می‌شود. این دستور باعث تغییر کلید رمزگذاری و از دست دادن دسترسی به فایل‌های رمزگذاری شده قبلی می‌شود. در صورت استفاده نادرست، ممکن است باعث از دست رفتن دسترسی به فایل‌های رمزگذاری شده شود، بنابراین با احتیاط استفاده کنید.

مثال:

1. ابتدا کلید رمزگذاری جاری را با دستور زیر تغییر دهید:

```
ansible-vault rekey encrypted_file.yml
```

2. سپس از شما رمز عبور فعلی را پرسیده و سپس شما باید رمز عبور جدید را وارد کنید.

**توجه:**
به دلیل محرمانگی و امنیت، از استفاده نادرست از دستور `ansible-vault rekey` خودداری کنید. اطمینان حاصل کنید که دسترسی به فایل‌های رمزگذاری شده بازیابی شده است قبل از انجام این عملیات.

